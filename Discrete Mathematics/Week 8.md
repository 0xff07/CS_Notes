# Week 8

## Thm (Solve Linear Recurrence)

假定有一個遞迴關係：
$$
T(n) = \sum_{i = 1}^k a_i T(n - i) + f(n)
$$
則以下方法得到的解，是這個遞迴關係的所有解：

1. 解 $G(n) = \sum_{i = 1}^k a_i G(n - i)$
2. 尋找一個解 $P(n)$，使得：$P(n) = \sum_{i = 1}^k a_i P(n - i) + f(n)$
3. $T(n) = G(n) + P(n)$ 即為所求。 

---

假定 $S(n)$ 是個 $T(n)$ 的解：
$$
\Delta(n) := S(n) - P(n) = \left(\sum_{i = 1}^{k}a_i S(n - i) + f(n)\right) - \left(\sum_{i = 1}^{k}a_i P(n - i) + f(n)\right) = \sum_{i = 1}^{k}a_i (S(n - i) - P(n - i))
$$
因此可知 $\Delta(n)$ 是Homogeneous Solution 的解。反之，所有具有 $T(n) = P(n) + G(n)$ 的解，帶入之後都滿足遞迴方程式。因此兩個集合一樣大。

---

例如：
$$
T(n) = 2T(n - 1) - 2 T(n - 2) + 2
$$
其中：
$$
\begin{cases}
T(0) = 2 \newline
 T(1) = 4
 \end{cases}
$$
「解 $G(n)$」：
$$
G(n) = C_1 (1 + i)^{n} + C_2 (1 - i)^{n}
$$
因為 $G(n)$ 要是實數，所以 $C_1 = \bar{C_2}$，即 $G(n)$ 需要有：
$$
G(n) = (c  +di) (1 + i)^{n} + (c - di)(1 - i)^{n}
$$
的形式。

「解 $P(n)$」：

猜：
$$
P(n) = c_0
$$
帶回得：
$$
c_0 = 2c_0 - 2c_0 + 2 \Rightarrow c_0 = 2
$$
故：
$$
P(n) = 2
$$
「解 $T(n)$」：

因此：
$$
T(n) = (c + di)(1 + i)^n + (c - di)(1 - i)^n + 2
$$
使用初始挑件：
$$
\begin{cases}
T(0) = 2c + 2 = 2\newline
T(1) = 2c - 2d + 2 = 4
\end{cases}
$$
因此解得：
$$
\begin{cases}
c = 0 \newline
d = -1
\end{cases}
$$
故：
$$
T(n) = -i(1 + i)^n + i (1 - i)^n + 2
$$
有些書會把它用利美佛定律化簡成：
$$
T(n) = 2 (\sqrt 2)^{n} \sin\left(\frac {n \pi}{4}\right) + 2
$$

---

### Observation (猜 P)

大致上有以下的方向：

| $f(n)$              | $P(n)$                               | 註解                                                         |
| ------------------- | ------------------------------------ | ------------------------------------------------------------ |
| $P_d (n) \cdot r^n$ | $P_d'(n) \cdot r^n \cdot n^{\alpha}$ | $P_d, P_d' \in \mathbb P_d$ $\alpha$ 是 $r$ 在 特徵多項式的次數 |
| $g_1(n) + g_2(n)$   |                                      | 分開猜再加起來                                               |
|                     |                                      |                                                              |

以下提供一些例子：

| $f(n)$                               | $P(n)$                            | 註備                                                         |
| ------------------------------------ | --------------------------------- | ------------------------------------------------------------ |
| $T(n) = 3T(n - 1) + n^2 2^n$         | $(c_2 n^2 + c_1n + c_0)2^n$       |                                                              |
| $T(n) = 2T(n - 1) + n^2$             | $(c_2n^2 + c_1n + c_0) \cdot 1^n$ | $\begin{align}T(n) &= 2T(n - 1) + n^2 \newline
&= 2T(n - 1) + n^2 1^n
\end{align}$ |
| $T(n) = 3T(n - 1) + (1) \cdot 2^{n}$ | $c_0 2^n$                         |                                                              |
| $T(n) = 3 T(n - 1) + 2^n$            | $c_0 \cdot n \cdot 3^n$           | $3$ 是特徵多項式 $r - 3$ 的根，且重數是 1                    |
| $T(n) = 6T(n - 1) - 9T(n - 2) + 3^n$ | $c_0 \cdot 3^n \cdot n^2$         | $3$ 是特徵多項式 $r - 3$ 的根，且重數是 2                    |
| $T(n) = 3T(n - 1) + 2^n + 5^n$       | $c_1 2^n + c_2 5^n$               | 分開猜再加起來                                               |



